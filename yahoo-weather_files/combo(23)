
/* index.js c7726a5 */ YUI().add("media-index",function(d){var b=function(){if(typeof console=="object"&&typeof console.log=="function"){var e=Array.prototype.slice.call(arguments);console.log.apply(console,e)}};var a=function(){if(this._isDebug){this.log.apply(this,arguments)}};d.namespace("Media.Index");var c=d.Media.Index;c.BreakingNews={init:function(f){var e=f.mod_id||".yom-breaking-news",h=parseInt(f.ticker_duration)||3,g=0.8,i=(h+g)*1000;d.on("domready",function(p){var q=d.all(e+" .bd ul li");if(q.size()<2){return}var j,n=0,o=q.size(),r=q.item(0).get("offsetHeight");var k=new d.Anim({from:{top:0},to:{top:-(r)},easing:d.Easing.easeOut,duration:g});var l=new d.Anim({from:{top:r},to:{top:0},easing:d.Easing.easeOut,duration:g});var m=function(){k.set("node",q.item(n));k.run();n=(n+1)%o;l.set("node",q.item(n));l.run();clearTimeout(j);j=setTimeout(m,i)};j=setTimeout(m,i);d.on("mouseover",function(){clearTimeout(j)},q);d.on("mouseout",function(){clearTimeout(j);j=setTimeout(m,i)},q)})}};c.StoryList={init:function(){d.on("contentready",function(l){var m=d.one("#story-list-view .hd .headline");var k=d.one("#story-list-view .hd .thumb");var j=d.one(".story-list .yom-list-wide");var h=d.one("#story-list-view .filter-change");if(h!==null){var g=function(D){D.preventDefault();var s=d.one(".story-list");var u=d.one("#storylist-s");var E=d.one("#storylist-p");var t=d.one("#storylist-t");var y=d.one("#story-list-view");var p=d.one(".most-popular-list");var z=d.one("#storylist-mp");var x=d.one("#storylist-mt");var A=window.location.pathname;A=(A!==null)?A.split("/"):A;var r=(A.length===4)?A[2]:(A.length===3?A[1]:(A.length===5?A[3]:null));var v=u.get("value").replace(/\//g,"");if(r!==null){var q="";if(z!==null){var F=new Array();var C=0;y.all("select option:first-child").each(function(e){if(e.get("selected")===true){C++}});if(y.all("select").size()!==C){var n=new Array();if(v!==""){n.push(v)}var o=z.get("value");if(o!==""){n.push(o)}n=n.join("--");F.push(n)}F.push(r);var w=x.get("value");if(x.all("option:first-child")){x.all("option:first-child")}if(w!==""){if(x.one("option")===null){F.push(w+"--1.html")}else{if(x.one("option").get("selected")===false){F.push(w+"--1.html")}else{F.push("1.html")}}}else{F.push("1.html")}q="/"+F.join("/")}if(E!==null&&u!==null){var F=new Array();var C=0;y.all("select option:first-child").each(function(e){if(e.get("selected")===true){C++}});if(y.all("select").size()!==C){if(E.one("option").get("selected")===true&&u.one("option").get("selected")===false){F.push(v)}else{F.push(E.get("value")+"--"+v)}}F.push(r);var B=t.get("value");if(B!==""&&t.one("option").get("selected")===false){F.push(B.toLowerCase()+"--1.html")}else{F.push("1.html")}q="/"+F.join("/")}if(q){window.location.href=q}}};d.on("click",g,h)}if(m!==null&&k!==null){var i=function(n){var o=d.io("/set-cookies/?m=MediaStoryList&v=1");m.set("className","headline yom-button selected");j.set("className","yom-list yom-list-wide headline");k.removeClass("selected");k.addClass("on")};d.on("click",i,m);var f=function(n){var o=d.io("/set-cookies/?m=MediaStoryList&v=2");k.set("className","thumb yom-button selected");j.set("className","yom-list-wide thumbnail");m.removeClass("selected");m.addClass("on")};d.on("click",f,k)}},["#story-list-view"])}};c.ListView={init:function(){d.on("contentready",function(h){var f=this.one(".menu");var g=this.one(".filter-content");var i=function(j){if(this.hasClass("off")){this.removeClass("off");f.addClass("off")}else{this.addClass("off");f.removeClass("off")}};d.on("click",i,g)},["story-list-view"])}};c.SectionList={init:function(o){var p=d.one("#"+o.mod_id);var n=p.one(".bd");var g=o.menu_items[0].list_id;var e=new Array();var f=['<div class="menu">','<span class="menu-label default">{menu_label}</span>','<a class="yom-button" href="#" role="button">','<span class="arrow arrow-down">&nbsp;</span>',"</a>","</div>"].join("");var q=d.substitute(f,{menu_label:o.menu_label});p.one(".hd").prepend(q);if(o.menu_items.length>0){var l='<div class="overlay"><ul>';for(var k in o.menu_items){var j=(k===0)?' class="selected" ':"";l+=d.substitute("<li><a "+j+'href="#{list_id}">{name}</a></li>',o.menu_items[k])}l+="</ul></div>"}var h=new d.Overlay({align:{node:p.one(".hd .menu"),points:["tr","br"]},bodyContent:l,shim:false,tabIndex:null,visible:false,zIndex:"100000000"});h.render("#"+o.mod_id);var m=function(t,s,x){if(typeof x==="undefined"||s.status!="200"){return}var z,y,w;if(typeof e[x]!=="undefined"){z=e[x];n.setContent(z)}else{var A=d.Node.create(s.responseText).one(".bd");if(A){z=A.getContent()}else{z="<!-- xhr response was invalid -->";b("xhrCallback(): xhr response was invalid: ",s.responseText);return}n.setContent(z);var u=YMedia.rapid;if(u&&u.refreshModule&&u.isModuleTracked(o.mod_id)){u.refreshModule(o.mod_id,false);z=n.getContent()}e[x]=z}for(y=0,w=o.menu_items.length;y<w;y++){if(o.menu_items[y].list_id===x){break}}var v=o.menu_items[y];if(x===g){p.one(".menu-label").setContent(o.menu_label).addClass("default")}else{p.one(".menu-label").setContent(v.name).removeClass("default")}if(v.more_link_url&&v.more_link_text){if(p.one(".ft")===null){n.insert('<div class="ft"></div>',"after")}p.one(".ft").setStyle("visibility","visible").setContent(d.substitute('<div class="more"><a href="{more_link_url}">{more_link_text}</a></div>',v))}else{if(p.one(".ft")!==null&&p.one(".ft").getContent()===""){p.one("ft").remove()}}};p.all(".overlay a").on("click",function(u){var s=u.currentTarget;var r=n.getContent();u.halt();if(typeof e[g]==="undefined"){e[g]=r}h.hide();n.setContent('<div class="loading">&nbsp;</div>'+r);n.one("ul").setStyle("visibility","hidden");n.one(".loading").setStyle("width",n.get("offsetWidth"));p.all(".ft").setStyle("visibility","hidden");p.all(".overlay a").removeClass("selected");s.addClass("selected");var v=s.get("href").replace(/.*#/,"");if(typeof e[v]==="undefined"){var t=d.merge(o.xhr_data,{list_id:v,mod_id:o.mod_id});t=d.QueryString.stringify(t);var i={method:"GET",on:{complete:m},"arguments":v};d.io("/_xhr/section-list/?"+t,i)}else{m("",{status:"200",responseText:e[v]},v)}});d.one("body").on("click",function(i){h.hide()});p.one(".hd .yom-button").on("click",function(i){i.halt();h.set("align",{node:p.one(".hd .menu"),points:["tr","br"]});h.show()})}}},"1.1",{requires:["io","substitute","json-parse","node","event","anim","overlay","querystring-stringify"]});
/* topstory.js 8d07914 */ YUI().add("media-topstory",function(a){a.namespace("Media.Topstory");a.Media.Topstory=function(I){var k=this,O=(I.useJapi=="1"),f=I.tabbedListId||"",d=I.queryUrl,z=I.content_id,G=I.ids,u=I.apply_filter,M=I.filters,b=I.isClassickickEnabled,w=I.latestList,q=I.argsList,x=I.labels,p=I.defaultSec,e=I.spaceId,j="P#"+e,r=I.pagequery,J=r,t=I.more_inline,h=I.ads_refresh,o={},m={},c="yom-top-story-",i="yom-list",B="yom-list-pg-",A=false,H=0,L,s=I.popupswitch,l=a.all("#"+f+" .nav .tabs li"),E=a.one("#"+f+" .loading"),C,N=typeof I.enableRapidTracking!=="undefined"?I.enableRapidTracking:"0",g,P=H,y=a.one("#"+f+" ."+c+H),K=null,n=null,F=("1"===I.enableSC);this.init=function(){if(l.size()>=2){var Q=a.all(".yom-top-story .nav li a");a.delegate("click",function(R){this.tabClicked(R)},"#"+f+" .tabs","a",this,true)}else{H=0}if(t){a.delegate("click",function(R){this.moreClicked(R)},"#"+f,".more-inline",this,true);this.updateMoreLink(a.one("#"+f+" ."+c+"content-"+H))}if(l.size()>=2||t){this.cacheInitialData();this.initUlt()}a.after("ysc_login:logout_facebook",function(R){this.switchTabForSC(false)},this);a.after("ysc_sharing:status_changed",function(S,R){this.switchTabForSC(R)},this)};this.switchTabForSC=function(R){if(K===null){K=a.one("#"+f+" .nav .ysc-active a")}if(K===null){return}n=this.extractTabId(K);if(R){var Q="#"+f+" ."+c+"content-"+n;if(a.one(Q)){o[f]=o[f]||{};o[f][this.getCacheKey(n,0)]=a.one(Q).get("innerHTML");if(F){this.updateTabStyles(K,n);H=n;this.getTabItems(K)}}}else{if(H!==n){return}this.updateTabStyles(y,P);H=P;this.getTabItems(y)}};this.cacheInitialData=function(){var R,Q;R=a.one("#"+f+" .tabs li.selected a")||false;if(R===false){return}Q=this.extractTabId(R);H=Q;this.cache(Q)};this.tabClicked=function(S){g.spaceid="";var R={sec:this.getSec(S.target),slk:S.target.get("text"),pos:k.extractTabId(S.target),s:j};if(N!="0"){a.Global.fire("rapid-tracker:click",{data:{sec:R.sec,linkname:R.slk,pos:R.pos,keys:R}})}else{if(C&&(typeof C.beacon==="function")){C.beacon(R)}}g.spaceid=e;var U=S.target,T=this.extractTabId(U),Q;S.preventDefault();if(T===H){return}this.updateTabStyles(U,T);H=T;this.getTabItems(U)};this.moreClicked=function(V){var R=a.one("#"+f+" ."+c+H),U=a.one("#"+f+" ."+c+"content-"+H+" ."+i),Q=a.one("#"+f),S=V.target,T={};if(U&&U.hasClass(i+"-hasmore")){V.preventDefault();if(!Q.inViewportRegion(true)){Q.scrollIntoView(true)}this.updateTabStyles(R);T={sec:this.getSec(R),slk:S.get("text")};if(N!="0"){a.Global.fire("rapid-tracker:click",{mod_id:f,data:{sec:T.sec,linkname:T.slk,keys:T}})}else{if(C&&(typeof C.beacon==="function")){C.beacon(T)}}if(!R&&l.size()==0){R=a.one("#"+f+" .hd")}this.getTabItems(R,this.extractPageNumber(U))}};this.getTabItems=function(T,R){this.refreshAds();var S=this.extractTabId(T);if(m.id>=0){if(m.isInProgress()){m.abort()}}if(this.isCached(S,R)){var Q=1;this.updateContent(o[f][this.getCacheKey(S,R)],Q)}else{listId=G[S];latestOn=w[S];if(!latestOn){r=""}else{r=J}setTimeout(function(){k.getRemoteData(T,listId,latestOn,R)},0)}};this.updateTabStyles=function(R,T){var S="#"+f+" ."+c+H,Q=a.one("#"+f+" .bd");Q.get("children").addClass("hide");E.setStyle("height",L);E.removeClass("hide");if(R){a.one(S).removeClass("selected").get("parentNode").removeClass("selected");R.addClass("selected").get("parentNode").addClass("selected")}};this.getRemoteData=function(W,R,V,U){var T,S,Q;r=a.JSON.stringify(r);r=encodeURIComponent(r.substring(1,r.length-1));if(W&&W.hasClass("sc-loaded")){this.updateContent(null,1);return}T=(O)?"/_xhr/top-story-temp/":"/_xhr/top-story/";S=k.getSec(W);U=U||0;Q=a.substitute(d,{categories:q[H].categories?encodeURIComponent(a.JSON.stringify(q[H].categories)):"",content_id:z,apply_filter:u,filters:M,img_end:q[H].img_end,img_start:q[H].img_start,item_template:q[H].item_template,latest_on:V,list_id:R,list_source:q[H].list_source,max_summary_length:q[H].max_summary_length,max_title_length:q[H].max_title_length,pagequery:r,popup_switch:q[H].popup_switch,provider_switch:q[H].provider_switch,relatedcollections_index:q[H].relatedcollections_index,s:e,sec:S,selected_tab:H,story_start:(U*q[H].storycount)+(parseInt(q[H].storystart,10)),base_start:q[H].storystart,storycount:q[H].storycount,timestamp_switch:q[H].timestamp_switch,more_inline:t});m=a.io(T,{method:"POST",data:Q,on:{success:function(Y,X){k.updateFromNewData(W,U,X)},failure:function(Y,X){}}})};this.updateFromNewData=function(T,R,S){var Q=S&&S.responseText;if(Q){this.updateContent(Q);this.cache(this.extractTabId(T),R)}};this.updateContent=function(S,R){var U=a.one("#"+f+" ."+c+"content-"+H),Q,W,T;if(R!=1){Q=U.one("span");Q.setContent(S);if(t){Q=Q.one("."+i);if(Q){T=parseInt(this.extractPageNumber(Q),10);if(T&&a.Lang.isNumber(T)&&T>1){Q.set("start",((T-1)*q[H].storycount+1))}this.updateMoreLink(U,Q)}}var V=YMedia.rapid;if(V&&V.refreshModule&&V.isModuleTracked(f)){V.refreshModule(f,false)}if(b==="1"){a.Global.fire("ads:enhance",Q)}}U.removeClass("hide");E.addClass("hide");this.cleanPanelHeight(H);L=this.getPanelHeight()};this.updateMoreLink=function(R,Q){if(R){if(!Q){Q=R.one("span ."+i)}if(Q){if(!Q.hasClass("yom-list-hasmore")){moreLink=R.one(".more-inline");if(moreLink){moreLink.addClass("hide")}}}}};this.extractTabId=function(Q){return this.extractFromClass(Q,c)||0};this.extractPageNumber=function(Q){return this.extractFromClass(Q,B)};this.extractFromClass=function(R,T){if(R){var U=R.get("className").split(" ");for(var S=0,Q=U.length;S<Q;S++){if(0===U[S].indexOf(T)){return U[S].substring(T.length)}}}return null};this.isCached=function(Q,R){return o[f]&&o[f][this.getCacheKey(Q,R)]};this.cache=function(Q,R){if(Q){o[f]=o[f]||{};o[f][this.getCacheKey(Q,R)]=a.one("#"+f+" ."+c+"content-"+Q).get("innerHTML")}};this.getCacheKey=function(Q,R){if(R){Q=Q+"-"+R}return Q};this.getPanelHeight=function(){return(a.one("#"+f+" ."+c+"content-"+H).getStyle("height")=="0px")?"30px":a.one("#"+f+" ."+c+"content-"+H).getStyle("height")};this.cleanPanelHeight=function(Q){a.one("#"+f+" ."+c+"content-"+Q).setStyle("height",null);return true};this.getSec=function(S){var Q=this.extractTabId(S);if(Q==0&&p){return p}var R=S&&S.get("text").replace(/[^\d\w]/gi,"")||false;return R?"ln_"+R+"_gal":p};this.initUlt=function(){g={spaceid:e,events:{click:{"ymg-tabs-click-track":{tabs:{node:"a",data:function(S){var R=k.getSec(S.target),Q=S.target.get("text"),T=k.extractTabId(S.target);return{slk:Q,sec:R,pos:T}},bubbles:true}}}}};C=new YAHOO.Media.Tracking({conf:g,el:f,namespace:"ymg-tabs-click-track"})};this.refreshAds=function(){if(YUI.AdsDarla&&a.Lang.isArray(h)&&h.length>0){for(var Q=0,R=h.length;Q<R;Q++){if(!h[Q].counter){h[Q].counter=0}h[Q].refresh_frequency=parseInt(h[Q].refresh_frequency,10);h[Q].counter++;if(YUI.AdsDarla[h[Q].darla_id]&&(h[Q].counter%h[Q].refresh_frequency===0)){YUI.AdsDarla[h[Q].darla_id].fetch()}}}};if(s=='"1"'){var v=(f!=="")?"#"+f:".yom-top-story",D=new a.Media.Tooltip({containerId:v,classes:["yog-11u"],selector:".bd ul .nothumb .txt a"});D.setup()}}},"1.0",{requires:["event-base","event-mouseenter","event-delegate","json","io-base","node","node-base","overlay","anim","substitute","media-tooltip"]});
/* tooltip.js b87d915 */ YUI().add("media-tooltip",function(a){a.namespace("Media");a.Media.Tooltip=function(j){var b;var s=j?j:{};var o=function(){var u={containerId:"body",tooltipId:"tooltip",selector:"a",content:".preview",classes:[],width:"450",delayIn:0.1,delayOut:0.08,delayMove:0.5,delayGet:0.5,onMove:"hide",moveOffsetX:30,moveOffsetY:30,fadeIn:true,fadeOut:true,animDurationIn:0.1,animDurationOut:0.08,mouseOffsetX:15,mouseOffsetY:20,opacity:1};for(pref in u){s[pref]=typeof s[pref]!=="undefined"?s[pref]:u[pref]}};var h=function(){o()};var r=0;var p=0;var m=function(){var w={};var u=function(x){if(r!==0){return}var y=x.target;t(y);y.tooltip.e=x;l(y)};var v=function(x){clearTimeout(p);p="";var y=x.target;d(y)};a.delegate("mouseover",u,s.containerId,s.selector);a.delegate("mouseout",v,s.containerId,s.selector)};var t=function(u){if(typeof u.tooltip==="undefined"){u.tooltip={};if(u.get("alt")!==""){u.tooltip.alt=u.get("alt");u.set("alt","")}if(u.get("title")!==""){u.tooltip.title=u.get("title");u.set("title","")}}};var l=function(u){if(u.tooltip&&u.tooltip.tHide){clearTimeout(u.tooltip.tHide);u.tooltip.tHide=null}p=setTimeout(function(){f(u)},s.delayGet*1000)};var d=function(u){if(u.tooltip){if(u.tooltip.tShow){clearTimeout(u.tooltip.tShow);u.tooltip.tShow=null}if(s.delayOut===0){e(u)}else{if(!u.tooltip.tHide){u.tooltip.tHide=setTimeout(function(){e(u)},s.delayOut*0)}}}};var f=function(u){if(u.get("parentNode").one(s.content)){u.tooltip.content=u.get("parentNode").one(s.content).get("innerHTML");c(u)}else{if(u.get("parentNode").get("parentNode").one(s.content)){u.tooltip.content=u.get("parentNode").get("parentNode").one(s.content).get("innerHTML");c(u)}}};var c=function(u){if(u.tooltip.content&&u.tooltip.content!==""){if(s.delayIn===0){n(u)}else{if(!u.tooltip.tShow){u.tooltip.tShow=setTimeout(function(){n(u)},s.delayIn*1000)}}}};var n=function(x){if(x.tooltip.content&&x.tooltip.content!==""){b=q(x);var u=x.tooltip.content;if(u!==""){if(b&&b.one(".wrap")){b.one(".wrap").set("innerHTML",u);var v=function(){if(b.hasClass("off")){b.replaceClass("off","on")}b.setStyles({display:"block",visibility:"visible"});b.tooltip.allowHide=true};var w=function(){x.tooltip.animIn=new a.Anim({node:b,duration:s.animDurationIn,from:{opacity:0},to:{opacity:s.opacity}});b.setStyle("opacity","0");x.tooltip.animIn.on("start",v);x.tooltip.animIn.run()};if(s.fadeIn===true){w()}else{v()}r=1;k(x);if(x.tooltip.alt&&x.tooltip.alt!==""){x.set("alt","")}if(x.tooltip.title&&x.tooltip.title!==""){x.set("title","")}}}}};var e=function(v){if(v.tooltip&&b&&b.tooltip&&b.tooltip.allowHide===true){if(typeof b!=="undefined"){var u=function(){if(b.hasClass("on")){b.replaceClass("on","off")}b.setStyles({display:"none",visibility:"hidden"});g(v);if(v.tooltip.alt&&v.tooltip.alt!==""){v.set("alt",v.tooltip.alt)}if(v.tooltip.title&&v.tooltip.title!==""){v.set("title",v.tooltip.title)}b.tooltip.allowHide=false};if(s.fadeOut===true){v.tooltip.animOut=new a.Anim({node:b,duration:s.animDurationOut,from:{opacity:s.opacity},to:{opacity:0}});b.setStyle("opacity",s.opacity);v.tooltip.animOut.on("end",u);v.tooltip.animOut.run()}else{u()}r=0}}};var q=function(y){var v=a.one(document.body);var u={};var x={};if(!v.one("#"+s.tooltipId)){u='<div id="'+s.tooltipId+'" class="yom-dialog yom-tooltip"><div class="wrap"></div><div class="wraptooltip"></div></div>';x=v.create(u);v.insert(x);x=a.one("#"+s.tooltipId);x.setStyles({position:"absolute",display:"none",visibility:"hidden"});if(s.width!==""){x.setStyle("width",s.width)}if(s.classes&&s.classes.length>0){for(var w=0;w<s.classes.length;w++){if(!x.hasClass(s.classes[w])){x.addClass(s.classes[w])}}}if(x.hasClass("on")){x.replaceClass("on","off")}else{x.addClass("off")}x.tooltip={}}else{x=a.one("#"+s.tooltipId)}if(x){x.tooltip.evmouseover=x.on("mouseover",function(z){x.tooltip.allowHide=false});x.tooltip.evmouseout=x.on("mouseout",function(A){x.tooltip.allowHide=true;var z=A.relatedTarget;if(z&&z.ancestor("#"+x._node.id)===null){if(y.tooltip&&y.tooltip.tHide){clearTimeout(y.tooltip.tHide);y.tooltip.tHide=null}d(y)}})}return x};var k=function(v){if(b){var u=function(A){var y=b.get("viewportRegion");var z=b.get("region");var C=0,B=0;var x=35;marginY=35;if((A.pageX+s.mouseOffsetX)<0){C=x}else{if((A.pageX+s.mouseOffsetX+z.width+x)>y.width){C=A.pageX-s.mouseOffsetX-z.width}else{C=A.pageX+s.mouseOffsetX}}if((A.pageY+s.mouseOffsetY)<0){B=marginY}else{if((z.height+s.mouseOffsetY)>A.clientY){B=A.pageY+s.mouseOffsetY}else{if((A.pageY+s.mouseOffsetY+z.height+marginY)>y.height){B=A.pageY-s.mouseOffsetY-z.height}else{B=A.pageY+s.mouseOffsetY}}}var w=[C,B];b.setXY(w)};u(v.tooltip.e)}};var g=function(u){if(b&&b.tooltip.evmouseover){a.detach(b.tooltip.evmouseover)}if(b&&b.tooltip.evmousemove){a.detach(b.tooltip.evmousemove)}if(u.tooltip&&u.tooltip.tMove){clearTimeout(u.tooltip.tMove)}};var i={setup:function(){m()}};h();return i}},"0.1",{requires:["node","anim"]});